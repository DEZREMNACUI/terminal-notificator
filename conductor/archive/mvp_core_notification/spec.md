# 规格说明书: MVP 核心通知与上下文切换

## 1. 概述
本 Track 旨在构建 `terminal-notificator` 的最小可行性产品 (MVP)。核心目标是实现一个能够发送 macOS 系统通知并在用户点击通知时激活特定终端窗口的 CLI 工具。该工具将使用 Rust 编写，强调高性能和零配置体验。

## 2. 核心功能

### 2.1 命令行接口 (CLI)
- **参数解析**: 使用 `clap` 解析命令行参数。
- **基本用法**:
  ```bash
  terminal-notificator -t "标题" -m "消息内容"
  ```
- **帮助信息**: 支持 `--help` 显示使用说明。

### 2.2 上下文感知 (Context Awareness)
- **父进程探测**:
  - 程序启动时，自动识别调用该 CLI 的父进程（即终端模拟器，如 Cursor, Warp, iTerm2）。
  - 使用 `sysinfo` 获取进程树信息。
  - 获取父进程的 PID 和 Bundle ID。
- **无需配置**: 用户无需手动指定终端应用名称或 ID。

### 2.3 发送通知 (Notification Dispatch)
- **原生 API**: 直接调用 macOS `UserNotifications` 框架发送通知，不依赖 `osascript`。
- **内容**: 支持自定义标题和正文。
- **图标**: 使用默认图标（或根据父进程动态获取，MVP 可先使用通用图标）。

### 2.4 点击跳转 (Click-to-Focus)
- **事件监听**: 监听通知的点击事件。
- **窗口激活**:
  - 当通知被点击时，利用获取到的 Bundle ID 激活对应的终端应用程序。
  - 尝试恢复特定的窗口焦点（如果 API 支持），或者激活该应用的前台窗口。

## 3. 技术约束
- **语言**: Rust (Stable)。
- **依赖**:
  - `clap`: 命令行解析。
  - `sysinfo`: 系统进程信息。
  - `objc2` / `icrate` (或类似 crate): macOS Objective-C 运行时绑定。
- **分发**: 静态链接的单一二进制文件。
- **性能**: 启动到发送通知的延迟应在毫秒级别。

## 4. 验收标准
- [ ] 能够通过命令行发送带有标题和内容的通知。
- [ ] 通知弹出迅速，无明显延迟。
- [ ] 在 Cursor 中运行命令，点击通知后焦点自动切换回 Cursor。
- [ ] 在 Warp 中运行命令，点击通知后焦点自动切换回 Warp。
- [ ] 即使在没有 Rust 环境的 macOS 机器上，二进制文件也能直接运行。
